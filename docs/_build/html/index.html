
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Documentation of GWXtreme &#8212; GWXtreme 0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Auto Generated Documentation" href="code.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="documentation-of-gwxtreme">
<h1>Documentation of GWXtreme<a class="headerlink" href="#documentation-of-gwxtreme" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction:<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The GWXtreme package hosts the tools to compute the Bayes’ factor for two equations of
state of neutron star from gravitational-wave (GW) data. As an input this requires
posterior samples of masses and tidal-deformability obtained from parameter estimation
of GW data for.</p>
<p>In this current implementation, the code requires a careful choice of priors for the
parameter estimation (PE) runs to be conducted. Once the posterior samples are available
the GWXtreme allows the user to use one of the native neutron star equations of state,
or a supply their favorite equation of state via a text file to compute the Bayes’ factor
for the various models.</p>
</div>
<div class="section" id="the-prior">
<h2>The Prior:<a class="headerlink" href="#the-prior" title="Permalink to this headline">¶</a></h2>
<p>Currently, this package is equipped to handle posterior samples from only a specific type
of prior in the PE runs. It demands that the PE is conducted using a uniform prior in the
modified tidal-deformability parameters <span class="math notranslate nohighlight">\((\tilde{\Lambda}, \delta\tilde{\Lambda})\)</span>,
where these are defined as:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   \tilde{\Lambda} &amp; = &amp; \frac{8}{13}\left[(1 + 7\eta - 31\eta^2)(\Lambda_1 + \Lambda_2) + \sqrt{1 - 4\eta}\,(1 + 9\eta - 11\eta^2)(\Lambda_1 - \Lambda_2)\right] \\
   \delta\tilde{\Lambda} &amp; = &amp; \frac{1}{2}\left[\sqrt{1 - 4\eta}\left(1 - \frac{13272}{1319}\eta + \frac{8944}{1319}\eta^2\right)(\Lambda_1 + \Lambda_2) + \left(1 - \frac{15910}{1319}\eta + \frac{32850}{1319}\eta^2 + \frac{3380}{1319}\eta^3\right)(\Lambda_1 - \Lambda_2)\right]
\end{eqnarray}</div><p>The choice of this prior has an implication. It leads to some of the points having unphysical
tidal-deformabilities <span class="math notranslate nohighlight">\((\Lambda_1, \Lambda_2)\)</span>. This requires careful studies to
quantify its effect on the computed Bayes’ factor. More details on this is available below.</p>
</div>
<div class="section" id="the-method">
<h2>The Method:<a class="headerlink" href="#the-method" title="Permalink to this headline">¶</a></h2>
<p>Bayesian model selection is a technique of comparing two competing models by taking ratios of
marginalized likelihoods, also known as the Bayes’ factor. In this case the competing models
are the various tabulated neutron star equations of state. The likelihood function marginalized
over the part of the parameter space consistent with any given model, <span class="math notranslate nohighlight">\({\rm M_i}\)</span> is</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   \mathcal{L}_{marg}({\rm M_i}) = \int p\left(x|\mathcal{M}, q, \tilde{\Lambda}(\mathcal{M}, q | {\rm M_i}), \delta\tilde{\Lambda}(\mathcal{M}, q| {\rm M_i})\right) \,p(\mathcal{M}, q)\,d\mathcal{M}\,dq\,,
\end{eqnarray}</div><p>where, <span class="math notranslate nohighlight">\(x\)</span> is the gravitational-wave data, <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> is the chirp-mass defined as
<span class="math notranslate nohighlight">\(\frac{(m_1 m_2)^{3/5}}{(m_1 + m_2)^{1/5}}\)</span>, <span class="math notranslate nohighlight">\(q\)</span> is the mass ratio <span class="math notranslate nohighlight">\((m_2/m_1)\)</span>,
and <span class="math notranslate nohighlight">\((m_1, m_2)\)</span> being the mass of the heavier and the lighter object respectively.</p>
<p>In the above expression we are assuming that we have marginalized over all the other parameters
on which the signal morphology of the gravitational-wave depend. The equation of state model
being deterministic, fixes the values of <span class="math notranslate nohighlight">\(\tilde{\Lambda}\)</span> and
<span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span> for a choice of <span class="math notranslate nohighlight">\((\mathcal{M}, q)\)</span> thus, restricting the
possible values of the former, which we write as follows</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
     \mathcal{L}_{marg}({\rm M_i})  = \int p\left(x|\mathcal{M}, q, \tilde{\Lambda}, \delta\tilde{\Lambda}\right)\delta\left(\tilde{\Lambda} - \tilde{\Lambda}_{\rm M_i}(\mathcal{M}, q)\right) \delta\left(\delta\tilde{\Lambda} - \delta\tilde{\Lambda}_{\rm eos}(\mathcal{M}, q)\right) p(\mathcal{M}, q) d\mathcal{M} dq d\tilde{\Lambda}d\delta\tilde{\Lambda}\,.
\end{eqnarray}</div><p>Of course the first term in the integral is immediately identified to be the likelihood function
in <span class="math notranslate nohighlight">\(\left(\mathcal{M}, q, \tilde{\Lambda}, \delta\tilde{\Lambda}\right)\)</span>.</p>
<div class="math notranslate nohighlight">
\begin{equation}
     \mathcal{L}_{marg}({\rm M_i})  = \int \mathcal{L}\left(\mathcal{M}, q, \tilde{\Lambda}, \delta\tilde{\Lambda}\right)\,\delta\left(\tilde{\Lambda} - \tilde{\Lambda}_{\rm M_i}(\mathcal{M}, q)\right)\, \delta\left(\delta\tilde{\Lambda} - \delta\tilde{\Lambda}_{\rm M_i}(\mathcal{M}, q)\right) \,p(\mathcal{M}, q)\,d\mathcal{M}\,dq\,d\tilde{\Lambda}\,d\delta\tilde{\Lambda}\,.
\end{equation}</div><p>Thus, all we need now is to compute this likelihood function. This is where the results from the
parameter estimation is used. We conduct a Bayesian MCMC analysis of the gravitational wave data
using uniform priors on <span class="math notranslate nohighlight">\(\tilde{\Lambda}\)</span> and <span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span>.The likelihood
function can be extracted from this analysis by simply invoking Bayes’ theorem.</p>
<div class="math notranslate nohighlight">
\begin{equation}
     \mathcal{L}\left(\mathcal{M}, q, \tilde{\Lambda}, \delta\tilde{\Lambda}\right) = \frac{p\left(\mathcal{M}, q, \tilde{\Lambda}, \delta\tilde{\Lambda}\, | \,x\right)}{p(\mathcal{M}, q)\, p(\tilde{\Lambda}, \delta\tilde{\Lambda})}\,.
\end{equation}</div><p>The choice of the uniform prior on <span class="math notranslate nohighlight">\(\tilde{\Lambda}\)</span> and <span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span>
simplifies the aboves expression of likelihood such that the marginalized likelihood becomes</p>
<div class="math notranslate nohighlight">
\begin{equation}
     \mathcal{L}_{marg}({\rm M_i})  = \int p\left(\mathcal{M}, q, \tilde{\Lambda}, \delta\tilde{\Lambda}\, | \,x\right)\,\delta\left(\tilde{\Lambda} - \tilde{\Lambda}_{\rm eos}(\mathcal{M}, q\right)\, \delta\left(\delta\tilde{\Lambda} - \delta\tilde{\Lambda}_{\rm eos}(\mathcal{M}, q\right) \,d\mathcal{M}\,dq\,d\tilde{\Lambda}\,d\delta\tilde{\Lambda}\,.
\end{equation}</div><p>But this choice has implications. Independently varying the values of
<span class="math notranslate nohighlight">\(\tilde{\Lambda}\)</span> and <span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span> may lead to negative values in
<span class="math notranslate nohighlight">\(\Lambda_1\)</span> and <span class="math notranslate nohighlight">\(\Lambda_2\)</span>, the tidal-deformability of the individual
objects. Of course this is unphysical and one has to take careful steps to make sure that
this does not affect our results. We are saved by the fact that this posterior samples
are truly an intermediate step and final results is only obtained after integrating along
the equation of state curves, which presumably will pass through points that are never
going to be unphysical. Thus even though we are computing the posterior samples for all
the points which includes the unphysical points in the parameter space, we are however
only computing the integral at points that constitute physical waveform.</p>
</div>
<div class="section" id="the-approximation">
<h2>The Approximation:<a class="headerlink" href="#the-approximation" title="Permalink to this headline">¶</a></h2>
<p>We now make two approximations motivated by physical observations. We note that the
likelihood function is extremely sharply peaked in <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>, and hence can be
approximated with a delta-function. We also noted that the likelihood is actually
independent of <span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span>. Under the choice of the aforementioned
uniform prior, this can be written as</p>
<div class="math notranslate nohighlight">
\begin{equation}
     p\left(\mathcal{M}, q, \tilde{\Lambda}, \delta\tilde{\Lambda}|x\right) \propto p\left(q, \tilde{\Lambda}|x\right) \delta(\mathcal{M} - \mathcal{M}_0)\,,
\end{equation}</div><p>Performing the integrals in the evidence, one has</p>
<div class="math notranslate nohighlight">
\begin{equation}
     \mathcal{L}_{marg}({\rm M_i}) \propto \int p\left(q, \tilde{\Lambda}_{\rm M_i}(q, \mathcal{M}_0)\, | \,x\right)\,dq\,,
\end{equation}</div><p>where, <span class="math notranslate nohighlight">\(\mathcal{M}_0\)</span> is the value of chirp-mass where the likelihood is
peaked. This line integral is computed by approximating the likelihood by a kernel
density approximation. Finally, the Bayes factor between two competing models is
simply <span class="math notranslate nohighlight">\(\mathcal{L}_{marg}({\rm M_i})/\mathcal{L}_{marg}({\rm M_j})\)</span>.</p>
</div>
<div class="section" id="unphysicality-in-approximation-scheme">
<h2>Unphysicality in approximation scheme:<a class="headerlink" href="#unphysicality-in-approximation-scheme" title="Permalink to this headline">¶</a></h2>
<p>The approximation scheme allows us to reduce the dimensionality of the problem from
four to two. However, in doing so, we can no longer claim that the equation of state
curves don’t pass through the unphysical points. This is because we have essentially
suppressed the entire <span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span> coordinate. Within the validity
of this approximation, however we are rescued by the fact that the waveform generation
code simply uses the <span class="math notranslate nohighlight">\(\tilde{\Lambda}\)</span> to compute the waveforms. This means,
for all practical purpose we can fix <span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span> to some value that
keeps <span class="math notranslate nohighlight">\((\Lambda_1, \Lambda_2)\)</span> in the physical-space and let <span class="math notranslate nohighlight">\(\tilde{\Lambda}\)</span>
vary uniformly, we will still get the same results because likelihood is practically
independent of <span class="math notranslate nohighlight">\(\delta\tilde{\Lambda}\)</span>.</p>
<p>Nevertheless, one can modify the above method to restrict the computation in the
physical-space. To do this let us define a step-function
<span class="math notranslate nohighlight">\(V(q, \tilde{\Lambda}, \delta\tilde{\Lambda})\)</span> which is zero when the combination
of <span class="math notranslate nohighlight">\((q, \tilde{\Lambda}, \delta\tilde{\Lambda})\)</span> gives negative values of
<span class="math notranslate nohighlight">\((\Lambda_1\)</span> or <span class="math notranslate nohighlight">\(\Lambda_2)\)</span>, and one elsewhere. Using this step-function
we can write</p>
<div class="math notranslate nohighlight">
\begin{equation}
     p(q, \tilde{\Lambda} | x) = \frac{1}{N}\int p(q, \tilde{\Lambda}, \delta\tilde{\Lambda} | x)\, V(q, \tilde{\Lambda}, \delta\tilde{\Lambda})\,d\delta\tilde{\Lambda}\,,
\end{equation}</div><p>where,</p>
<div class="math notranslate nohighlight">
\begin{equation}
     N(q, \tilde{\Lambda}) = \int V(q, \tilde{\Lambda}, \delta\tilde{\Lambda})\,d\delta\tilde{\Lambda}\,.
\end{equation}</div><p>All we have to do now is to evaluate the weighted KDE to compute the above integral,
where the weight for each 2D posterior sample is the quantity
<span class="math notranslate nohighlight">\(N(q, \tilde{\Lambda})\)</span>.</p>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="code.html">Auto Generated Documentation</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">GWXtreme</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="code.html">Auto Generated Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="code.html" title="next chapter">Auto Generated Documentation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Shaon Ghosh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>